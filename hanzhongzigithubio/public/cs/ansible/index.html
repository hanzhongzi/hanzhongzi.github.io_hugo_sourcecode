



<!DOCTYPE html>
<html lang="en">

<head>
<title>Ansible</title>
<meta name="viewport"content="width=device-width, user-scalable=no, initial-scale=1.0, shrink-to-fit=no, viewport-fit=cover">

<meta name="description" content="Ansible ä¸€ç¯‡æå®šï¼Œå¿«é€Ÿå­¦ä¹ 
ä¸€ã€ç‰¹ç‚¹ æ¨¡å—åŒ–ï¼š è°ƒç”¨ç‰¹å®šçš„æ¨¡å—ï¼Œå®Œæˆç‰¹å®šçš„å†…å®¹ ä½¿ç”¨ Paramiko(Pythonå¯¹äºsshçš„å®ç°)ï¼ŒPyYAML,Jinja2(æ¨¡æ¿è¯­è¨€) ä¸‰ä¸ªå…³é”®æ¨¡å— æ”¯æŒè‡ªå®šä¹‰æ¨¡å—ï¼Œå¯ä»¥ä½¿ç”¨ä»»ä½•è¯­è¨€ç¼–å†™ åŸºäºPythonå®ç° ä¸æ˜¯ç®€å•ï¼ŒåŸºäºPythonå’ŒSSH,æ— agentï¼Œæ— éœ€ä»£ç†ï¼Œä¸ä¾èµ–PKI(æ— éœ€SSL) å®‰å…¨ï¼ŒåŸºäºOpenSSH å¹‚ç­‰æ€§ï¼šä¸€ä¸ªä»»åŠ¡æ‰§è¡Œä¸€éå’ŒNè¾¹ç»“æœæ˜¯ä¸€æ ·çš„ï¼ˆè¦æ³¨æ„ä»£ç é€»è¾‘ï¼‰ æ”¯æŒplaybookç¼–æ’ä»»åŠ¡ï¼ŒYAMLæ ¼å¼ï¼Œç¼–æ’ä»»åŠ¡ï¼Œæ”¯æŒä¸°å¯Œçš„æ•°æ®æœºæ„ è¾ƒå¼ºå¤§çš„roleçš„å¤šå±‚è§£å†³æ–¹æ¡ˆ äºŒã€æ¶æ„ ç”¨æˆ·/PLAYBOOK =&gt; INVENTORY/API/MODULES/PLUGINS =&gt; HOSTS/NETWORK INVEMTORY: Ansibleç®¡ç†ä¸»æœºçš„æ¸…å• /etc/ansible/hosts MODULES: Ansibleæ‰§è¡Œå‘½ä»¤çš„åŠŸèƒ½æ¨¡å—ã€å¤šæ•°ä¸ºå†…ç½®æ ¸å¿ƒæ¨¡å—ï¼Œä¹Ÿå¯ä»¥è‡ªå®šä¹‰ PLUGINS: æ¨¡å—åŠŸèƒ½çš„è¡¥å……ï¼Œå¦‚è¿æ¥ç±»å‹æ’ä»¶ã€å¾ªç¯æ’ä»¶ã€å˜é‡æ’ä»¶ã€è¿‡æ»¤æ’ä»¶ç­‰ API: ä¾›ç¬¬ä¸‰æ–¹ç¨‹åºè°ƒç”¨çš„åº”ç”¨ç¨‹åºæ¥å£ ç”¨æˆ·ç›´æ¥ä½¿ç”¨å‘½ä»¤æˆ–è€…ä½¿ç”¨ Playbook æˆ–è€… è°ƒç”¨API å»è¿œç¨‹ä¸»æœºæ‰§è¡Œå‘½ä»¤ ä¸‰ã€æ³¨æ„äº‹é¡¹ æ‰§è¡Œansibleçš„ä¸»æœºä¸€èˆ¬ç§°ä¸ºä¸»æ§ç«¯ï¼Œä¸­æ§ï¼Œmasteræˆ–å ¡å’æœº ä¸»æ§æ®µpythonéœ€è¦åœ¨2.6æˆ–ä»¥ä¸Š è¢«æ§ç«¯pythonç‰ˆæœ¬å°é±¼2.4çš„éœ€è¦å®‰è£… python-simplejson windowsä¸èƒ½ä½œä¸ºä¸»æ§ å››ã€å®‰è£… epelæºrpmåŒ…å®‰è£… sudo yum -y install epel-release &amp;&amp; sudo yum -y install ansible
å®˜æ–¹å…¶ä»–å®‰è£…æ–¹å¼
æŸ¥çœ‹å®‰è£…ç‰ˆæœ¬å’Œå‘½ä»¤
ansible --version ansible 2.9.27 config file = /etc/ansible/ansible.cfg configured module search path = [u&#39;/root/.ansible/plugins/modules&#39;, u&#39;/usr/share/ansible/plugins/modules&#39;] ansible python module location = /usr/lib/python2.">

<meta itemprop="name" content="Ansible">
<meta itemprop="description" content="Ansible ä¸€ç¯‡æå®šï¼Œå¿«é€Ÿå­¦ä¹ 
ä¸€ã€ç‰¹ç‚¹ æ¨¡å—åŒ–ï¼š è°ƒç”¨ç‰¹å®šçš„æ¨¡å—ï¼Œå®Œæˆç‰¹å®šçš„å†…å®¹ ä½¿ç”¨ Paramiko(Pythonå¯¹äºsshçš„å®ç°)ï¼ŒPyYAML,Jinja2(æ¨¡æ¿è¯­è¨€) ä¸‰ä¸ªå…³é”®æ¨¡å— æ”¯æŒè‡ªå®šä¹‰æ¨¡å—ï¼Œå¯ä»¥ä½¿ç”¨ä»»ä½•è¯­è¨€ç¼–å†™ åŸºäºPythonå®ç° ä¸æ˜¯ç®€å•ï¼ŒåŸºäºPythonå’ŒSSH,æ— agentï¼Œæ— éœ€ä»£ç†ï¼Œä¸ä¾èµ–PKI(æ— éœ€SSL) å®‰å…¨ï¼ŒåŸºäºOpenSSH å¹‚ç­‰æ€§ï¼šä¸€ä¸ªä»»åŠ¡æ‰§è¡Œä¸€éå’ŒNè¾¹ç»“æœæ˜¯ä¸€æ ·çš„ï¼ˆè¦æ³¨æ„ä»£ç é€»è¾‘ï¼‰ æ”¯æŒplaybookç¼–æ’ä»»åŠ¡ï¼ŒYAMLæ ¼å¼ï¼Œç¼–æ’ä»»åŠ¡ï¼Œæ”¯æŒä¸°å¯Œçš„æ•°æ®æœºæ„ è¾ƒå¼ºå¤§çš„roleçš„å¤šå±‚è§£å†³æ–¹æ¡ˆ äºŒã€æ¶æ„ ç”¨æˆ·/PLAYBOOK =&gt; INVENTORY/API/MODULES/PLUGINS =&gt; HOSTS/NETWORK INVEMTORY: Ansibleç®¡ç†ä¸»æœºçš„æ¸…å• /etc/ansible/hosts MODULES: Ansibleæ‰§è¡Œå‘½ä»¤çš„åŠŸèƒ½æ¨¡å—ã€å¤šæ•°ä¸ºå†…ç½®æ ¸å¿ƒæ¨¡å—ï¼Œä¹Ÿå¯ä»¥è‡ªå®šä¹‰ PLUGINS: æ¨¡å—åŠŸèƒ½çš„è¡¥å……ï¼Œå¦‚è¿æ¥ç±»å‹æ’ä»¶ã€å¾ªç¯æ’ä»¶ã€å˜é‡æ’ä»¶ã€è¿‡æ»¤æ’ä»¶ç­‰ API: ä¾›ç¬¬ä¸‰æ–¹ç¨‹åºè°ƒç”¨çš„åº”ç”¨ç¨‹åºæ¥å£ ç”¨æˆ·ç›´æ¥ä½¿ç”¨å‘½ä»¤æˆ–è€…ä½¿ç”¨ Playbook æˆ–è€… è°ƒç”¨API å»è¿œç¨‹ä¸»æœºæ‰§è¡Œå‘½ä»¤ ä¸‰ã€æ³¨æ„äº‹é¡¹ æ‰§è¡Œansibleçš„ä¸»æœºä¸€èˆ¬ç§°ä¸ºä¸»æ§ç«¯ï¼Œä¸­æ§ï¼Œmasteræˆ–å ¡å’æœº ä¸»æ§æ®µpythonéœ€è¦åœ¨2.6æˆ–ä»¥ä¸Š è¢«æ§ç«¯pythonç‰ˆæœ¬å°é±¼2.4çš„éœ€è¦å®‰è£… python-simplejson windowsä¸èƒ½ä½œä¸ºä¸»æ§ å››ã€å®‰è£… epelæºrpmåŒ…å®‰è£… sudo yum -y install epel-release &amp;&amp; sudo yum -y install ansible
å®˜æ–¹å…¶ä»–å®‰è£…æ–¹å¼
æŸ¥çœ‹å®‰è£…ç‰ˆæœ¬å’Œå‘½ä»¤
ansible --version ansible 2.9.27 config file = /etc/ansible/ansible.cfg configured module search path = [u&#39;/root/.ansible/plugins/modules&#39;, u&#39;/usr/share/ansible/plugins/modules&#39;] ansible python module location = /usr/lib/python2.">
<meta itemprop="image" content="https://hanzhongzi.github.io/img/author.jpg">


<meta name="twitter:description" content="">


<link rel="alternate" href="https://hanzhongzi.github.io/feed.xml" title="ç€šä¸­å­çš„ä¸ªäººç½‘ç«™" type="application/rss+xml"/>

<link rel="shortcut icon" href="https://hanzhongzi.github.io/imgs/icons/favicon.ico"/>
<link rel="apple-touch-icon" href="https://hanzhongzi.github.io/imgs/icons/apple-touch-icon.png" />
<link rel="apple-touch-icon-precomposed" href="https://hanzhongzi.github.io/imgs/icons/apple-touch-icon.png" />




<style>
    @font-face {
        font-family: 'Xc Font';
        font-weight: 400;
        font-style: normal;
        font-display: swap;
        src: url('https://cdn.jsdelivr.net/gh/Xpblog666/cdn@1.0/HarmonyOS_Sans_SC_Medium.ttf');
        src: url('https://cdn.jsdelivr.net/gh/Xpblog666/cdn@1.0/HarmonyOS_Sans_SC_Medium.ttf') format('truetype');
    }

    html {
        font-family: 'Xc Font', 'PingFang SC', 'Noto Serif SC', 'HarmonyOS_Sans_SC_Medium', 'Fira Mono', 'Microsoft YaHei', Arial, sans-serif
    }

    html .Qc_header_above .Qc_container {
        max-width: 1720px
    }

    html .Qc_header_below .Qc_container {
        max-width: 1720px
    }

    html .Qc_header_searchout .Qc_container {
        max-width: 1720px
    }

    html .Qc_main {
        max-width: 980px
    }

    html .Qc_aside {
        width: 260px
    }

    body::before {
        background: #f0f0f0;
        background: ;
        background-position: center 0;
        background-repeat: no-repeat;
        background-size: cover;
    }
</style>


<link rel="stylesheet" href="https://hanzhongzi.github.io/css/global.min.css" />
<link rel="stylesheet" href="https://hanzhongzi.github.io/css/style.css" />
<link rel="stylesheet" href="https://hanzhongzi.github.io/css/theme.min.css" />

<link rel="stylesheet" href="https://hanzhongzi.github.io/css/font-awesome.min.css" />


<link rel="stylesheet" href="https://unpkg.com/@waline/client@v2/dist/waline.css" />



<script type="module">
    import { init } from 'https://unpkg.com/@waline/client@v2/dist/waline.mjs';
  
    init({
      el: '.waline-container',
      placeholder: "è¯·ä¸è¦åå•¬æ‚¨çš„è¯„è®º ãƒ¾(â‰§â–½â‰¦*)o",
      sofa: "ç§ï¼Œè¿™é‡Œæ²¡äººï¼Œè¿˜ä¸æŠ¢å ç¬¬ä¸€çš„ä½ç½® (â‰§âˆ€â‰¦)ã‚",
      pageview: true, 
      comment: true, 
      emoji: [
        '//unpkg.com/@waline/emojis@1.1.0/weibo',
        '//unpkg.com/@waline/emojis@1.1.0/bilibili',
      ],
      login: 'disable',
      imgUploader: false,
      wordLimit: 200,
      requiredMeta: ['nick', 'mail'],
      reaction: true,
      reactionText: [ 'ç‚¹èµ', 'è¸©ä¸€ä¸‹', 'å¾—æ„', 'ä¸å±‘', 'å°´å°¬', 'ç¡è§‰'],
      reactionTitle: "æ‚¨è®¤ä¸ºè¿™ç¯‡æ–‡ç« æ€ä¹ˆæ ·ï¼Ÿ",
      dark: 'auto', 
      serverURL: "comment.qiucode.cn",
    });
  </script>
  









 
 


  
  









    
    







                
 
    

























</head>

<body>
	<header class="Qc_header  active Qc_slid">
<div class="Qc_header_above">
    <div class="Qc_container"> 
        <svg class="Qc_header_above-slideicon" viewBox="0 0 1152 1024"
            xmlns="http://www.w3.org/2000/svg" width="20" height="20">
            <path
                d="M76.032 872a59.968 59.968 0 1 0 0 120h999.936a59.968 59.968 0 1 0 0-120H76.032zm16-420.032a59.968 59.968 0 1 0 0 120h599.936a59.968 59.968 0 1 0 0-119.936H92.032zM76.032 32a59.968 59.968 0 1 0 0 120h999.936a60.032 60.032 0 0 0 0-120H76.032z" />
        </svg> 
        <a class="Qc_header_above-logo" href="/" title="John'Blog"> 
            <img class="Qc_logo"
                src="/static/front/images/qiu-logo.png" /></a>
        <nav class="Qc_header_above_nav"> 
            
            <a class="item " href="/" title="é¦–é¡µ" style="margin-right:8px">
                <i class="fa fa-home"></i> é¦–é¡µ
            </a>
           
            <a class="item " href="/flinks" title="å‹æƒ…é“¾æ¥">
                <i class="fa fa-link"></i>å‹æƒ…é“¾æ¥
            </a> 


            <a class="item " href="/about" title="å…³äºæˆ‘">
                <i class="fa fa-user"></i>å…³äºæœ¬ç«™
            </a>
        </nav> 

        
        
        <svg class="Qc_header_above-searchicon" viewBox="0 0 1024 1024"
            xmlns="http://www.w3.org/2000/svg" width="20" height="20" style="display: block;">
            <path
                d="M1008.19 932.031L771.72 695.56a431.153 431.153 0 1 0-76.158 76.158l236.408 236.472a53.758 53.758 0 0 0 76.158 0 53.758 53.758 0 0 0 0-76.158zM107.807 431.185a323.637 323.637 0 0 1 323.316-323.381 323.7 323.7 0 0 1 323.381 323.38 323.637 323.637 0 0 1-323.38 323.317 323.637 323.637 0 0 1-323.317-323.316z" />
        </svg> 
        <a href="javascript:void(0)" type="button" id="ClickMe" style="margin: 0px 3px 2px 13px"><svg
                t="1675873194952" class="loingico" viewBox="0 0 1024 1024" version="1.1"
                xmlns="http://www.w3.org/2000/svg" p-id="3929" width="22" height="22">
                <path
                    d="M554.666667 349.44a48.213333 48.213333 0 1 1-47.786667 47.786667A48.213333 48.213333 0 0 1 554.666667 349.44m0-85.333333a133.546667 133.546667 0 1 0 133.546666 133.12A133.12 133.12 0 0 0 554.666667 264.106667z"
                    fill="var(--routine)" p-id="3930"></path>
                <path
                    d="M768 759.893333a42.666667 42.666667 0 0 1-42.666667-42.666666 170.666667 170.666667 0 0 0-341.333333 0 42.666667 42.666667 0 0 1-85.333333 0 256 256 0 0 1 512 0 42.666667 42.666667 0 0 1-42.666667 42.666666z"
                    fill="var(--routine)" p-id="3931"></path>
                <path
                    d="M554.666667 213.333333a341.333333 341.333333 0 1 1-341.333334 341.333334 341.333333 341.333333 0 0 1 341.333334-341.333334m0-85.333333a426.666667 426.666667 0 1 0 426.666666 426.666667A426.666667 426.666667 0 0 0 554.666667 128z"
                    fill="var(--routine)" p-id="3932"></path>
            </svg> </a>
       
    </div>
</div>

<div class="Qc_header_slideout"> 
    <img width="100%" height="150" class="Qc_header_slideout-image"
        src="https://qiucode.cn/shaonv.jpg" alt="ä¾§è¾¹æ å£çº¸" />
    <div class="Qc_header_slideout-author"> <img width="50" height="50" class="avatar"
            src="https://thirdqq.qlogo.cn/g?b=qq&nk=687778&s=100" alt="åšä¸»æ˜µç§°" />
        <div class="info"> <a class="link" href="https://qiucode.cn" target="_blank"
                rel="noopener noreferrer nofollow">John</a>
            <p class="motto Qc_motto"></p>
        </div>
    </div>
    <ul class="Qc_header_slideout-count"> </ul>
    <ul class="Qc_header_slideout-menu panel-box">
        <li> <a class="link" href="https://qiucode.cn/" title="é¦–é¡µ"> <span><i class="iconfont icon-A131"></i>
                    é¦–é¡µ</span> </a> </li>
        <li> <a class="link panel" href="#" rel="nofollow"> <span><i class="iconfont icon-A129"></i> åˆ†ç±»</span>
                <svg class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" width="13"
                    height="13">
                    <path
                        d="M624.865 512.247L332.71 220.088c-12.28-12.27-12.28-32.186 0-44.457 12.27-12.28 32.186-12.28 44.457 0l314.388 314.388c12.28 12.27 12.28 32.186 0 44.457L377.167 848.863c-6.136 6.14-14.183 9.211-22.228 9.211s-16.092-3.071-22.228-9.211c-12.28-12.27-12.28-32.186 0-44.457l292.155-292.16z" />
                </svg> </a>
            <ul class="slides panel-body panel-box">
                <li>
                    <div class="link panel "> <a href="https://qiucode.cn/category/default/" title="æ—¥å¸¸åˆ†äº«">æ—¥å¸¸åˆ†äº«</a>
                        <svg class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" width="13"
                            height="13">
                            <path
                                d="M624.865 512.247L332.71 220.088c-12.28-12.27-12.28-32.186 0-44.457 12.27-12.28 32.186-12.28 44.457 0l314.388 314.388c12.28 12.27 12.28 32.186 0 44.457L377.167 848.863c-6.136 6.14-14.183 9.211-22.228 9.211s-16.092-3.071-22.228-9.211c-12.28-12.27-12.28-32.186 0-44.457l292.155-292.16z" />
                        </svg> </div>
                    <ul class="slides panel-body">
                        <li><a class="link " href="https://qiucode.cn/category/wmfx/" title="å¤–è´¸åˆ†äº«">å¤–è´¸åˆ†äº«</a></li>
                        <li><a class="link " href="https://qiucode.cn/category/wztj/" title="ç½‘ç«™æ¨è">ç½‘ç«™æ¨è</a></li>
                        <li><a class="link " href="https://qiucode.cn/category/yxxg/" title="æ¸¸æˆç›¸å…³">æ¸¸æˆç›¸å…³</a></li>
                    </ul>
                </li>
                <li><a class="link " href="https://qiucode.cn/category/xitong/" title="ç³»ç»Ÿç›¸å…³">ç³»ç»Ÿç›¸å…³</a></li>
                <li>
                    <div class="link panel "> <a href="https://qiucode.cn/category/wangzhan/"
                            title="ç½‘ç«™æ–‡æ¡£">ç½‘ç«™æ–‡æ¡£</a> <svg class="icon" viewBox="0 0 1024 1024"
                            xmlns="http://www.w3.org/2000/svg" width="13" height="13">
                            <path
                                d="M624.865 512.247L332.71 220.088c-12.28-12.27-12.28-32.186 0-44.457 12.27-12.28 32.186-12.28 44.457 0l314.388 314.388c12.28 12.27 12.28 32.186 0 44.457L377.167 848.863c-6.136 6.14-14.183 9.211-22.228 9.211s-16.092-3.071-22.228-9.211c-12.28-12.27-12.28-32.186 0-44.457l292.155-292.16z" />
                        </svg> </div>
                    <ul class="slides panel-body">
                        <li><a class="link " href="https://qiucode.cn/category/bkfx/" title="åšå®¢åˆ†äº«">åšå®¢åˆ†äº«</a></li>
                        <li><a class="link " href="https://qiucode.cn/category/wzym/" title="ç½‘ç«™æºç ">ç½‘ç«™æºç </a></li>
                    </ul>
                </li>
                <li>
                    <div class="link panel "> <a href="https://qiucode.cn/category/ruanjian/"
                            title="è½¯ä»¶åˆ†äº«">è½¯ä»¶åˆ†äº«</a> <svg class="icon" viewBox="0 0 1024 1024"
                            xmlns="http://www.w3.org/2000/svg" width="13" height="13">
                            <path
                                d="M624.865 512.247L332.71 220.088c-12.28-12.27-12.28-32.186 0-44.457 12.27-12.28 32.186-12.28 44.457 0l314.388 314.388c12.28 12.27 12.28 32.186 0 44.457L377.167 848.863c-6.136 6.14-14.183 9.211-22.228 9.211s-16.092-3.071-22.228-9.211c-12.28-12.27-12.28-32.186 0-44.457l292.155-292.16z" />
                        </svg> </div>
                    <ul class="slides panel-body">
                        <li><a class="link " href="https://qiucode.cn/category/sjrj/" title="ğŸ“±æ‰‹æœºè½¯ä»¶">ğŸ“±æ‰‹æœºè½¯ä»¶</a>
                        </li>
                        <li><a class="link " href="https://qiucode.cn/category/dnrj/" title="ğŸ’»ç”µè„‘è½¯ä»¶">ğŸ’»ç”µè„‘è½¯ä»¶</a>
                        </li>
                    </ul>
                </li>
            </ul>
        </li>
        <li> <a class="link panel" href="#" rel="nofollow"> <span><i class="iconfont icon-A3"></i> é¡µé¢</span>
                <svg class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" width="13"
                    height="13">
                    <path
                        d="M624.865 512.247L332.71 220.088c-12.28-12.27-12.28-32.186 0-44.457 12.27-12.28 32.186-12.28 44.457 0l314.388 314.388c12.28 12.27 12.28 32.186 0 44.457L377.167 848.863c-6.136 6.14-14.183 9.211-22.228 9.211s-16.092-3.071-22.228-9.211c-12.28-12.27-12.28-32.186 0-44.457l292.155-292.16z" />
                </svg> </a>
            <ul class="slides panel-body">
                <li><a class="link " href="https://qiucode.cn/sn.html" title="æˆ‘çš„è®°å½•">æˆ‘çš„è®°å½•</a></li>
                <li><a class="link " href="https://qiucode.cn/youlian.html" title="å‹æƒ…é“¾æ¥">å‹æƒ…é“¾æ¥</a></li>
                <li><a class="link " href="https://qiucode.cn/site.html" title="ç«™ç‚¹ç»Ÿè®¡">ç«™ç‚¹ç»Ÿè®¡</a></li>
                <li><a class="link " href="https://qiucode.cn/Aboutme.html" title="å…³äºæˆ‘">å…³äºæˆ‘</a></li>
            </ul>
        </li>
    </ul>
    <ul class="Qc_header_slideout-menu panel-box" style="margin-top: 15px;margin-bottom: 100px;">
        <li> <a class="link panel" href="#" rel="nofollow"> <span><i class="iconfont icon-A17"></i> ç”¨æˆ·ç™»å½•</span>
                <svg class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" width="13"
                    height="13">
                    <path
                        d="M624.865 512.247L332.71 220.088c-12.28-12.27-12.28-32.186 0-44.457 12.27-12.28 32.186-12.28 44.457 0l314.388 314.388c12.28 12.27 12.28 32.186 0 44.457L377.167 848.863c-6.136 6.14-14.183 9.211-22.228 9.211s-16.092-3.071-22.228-9.211c-12.28-12.27-12.28-32.186 0-44.457l292.155-292.16z">
                    </path>
                </svg> </a>
            <ul class="slides panel-body">
                <li> <a class="link" href="https://qiucode.cn/admin/login.php" target="_blank"
                        rel="noopener noreferrer nofollow">ç™»å½•</a> <a class="link"
                        href="https://qiucode.cn/admin/register.php" target="_blank"
                        rel="noopener noreferrer nofollow">æ³¨å†Œ</a> </li>
            </ul>
        </li>
    </ul>
</div>
<div class="Qc_header_mask"></div>

<script>

    let sideBtn = document.querySelector(".Qc_header_above .Qc_container .Qc_header_above-slideicon")

    sideBtn.addEventListener("click", () => {
        document.querySelector(".Qc_header_slideout").classList.add("active")
        document.querySelector(".Qc_header_mask").classList.add("active")
    })

    let maskBtn = document.querySelector(".Qc_header_mask")

    maskBtn.addEventListener("click",() => {
        document.querySelector(".Qc_header_slideout").classList.remove("active")
        maskBtn.classList.remove("active")
    })

   
    

</script></header>
	
	<div class="Qc_container showInUp">



<div class="Qc_main Qc_post">
    <div class="Qc_detail">
        <h1 class="title Qc_psot_title"> Ansible</h1>
        <div class="Qc_bread">
            <ul class="Qc_bread_bread">
                <li class="item"> <span class="iconfont icon-A131" style="margin-right: 4px;"></span> <a
                        href="https://qiucode.cn/" class="link" title="é¦–é¡µ">é¦–é¡µ</a> </li>
                <li class="line">/</li>
                <li class="item"> <a class="link" href="https://qiucode.cn/category/bkfx/" title="åšå®¢åˆ†äº«">åšå®¢åˆ†äº«</a>
                </li>
                <li class="line">/</li>
                <li class="item">æ­£æ–‡</li>
            </ul>
        </div>
        <div class="Qc_detail_category"> </div>
        <article class="Qc_detail_article" id="article-container">
            <h1 id="ansible">Ansible</h1>
<p>ä¸€ç¯‡æå®šï¼Œå¿«é€Ÿå­¦ä¹ </p>
<hr>
<h2 id="ä¸€ç‰¹ç‚¹">ä¸€ã€ç‰¹ç‚¹</h2>
<ul>
<li>æ¨¡å—åŒ–ï¼š è°ƒç”¨ç‰¹å®šçš„æ¨¡å—ï¼Œå®Œæˆç‰¹å®šçš„å†…å®¹</li>
<li>ä½¿ç”¨ Paramiko(Pythonå¯¹äºsshçš„å®ç°)ï¼ŒPyYAML,Jinja2(æ¨¡æ¿è¯­è¨€) ä¸‰ä¸ªå…³é”®æ¨¡å—</li>
<li>æ”¯æŒè‡ªå®šä¹‰æ¨¡å—ï¼Œå¯ä»¥ä½¿ç”¨ä»»ä½•è¯­è¨€ç¼–å†™</li>
<li>åŸºäºPythonå®ç°</li>
<li>ä¸æ˜¯ç®€å•ï¼ŒåŸºäºPythonå’ŒSSH,æ— agentï¼Œæ— éœ€ä»£ç†ï¼Œä¸ä¾èµ–PKI(æ— éœ€SSL)</li>
<li>å®‰å…¨ï¼ŒåŸºäºOpenSSH</li>
<li>å¹‚ç­‰æ€§ï¼šä¸€ä¸ªä»»åŠ¡æ‰§è¡Œä¸€éå’ŒNè¾¹ç»“æœæ˜¯ä¸€æ ·çš„ï¼ˆè¦æ³¨æ„ä»£ç é€»è¾‘ï¼‰</li>
<li>æ”¯æŒplaybookç¼–æ’ä»»åŠ¡ï¼ŒYAMLæ ¼å¼ï¼Œç¼–æ’ä»»åŠ¡ï¼Œæ”¯æŒä¸°å¯Œçš„æ•°æ®æœºæ„</li>
<li>è¾ƒå¼ºå¤§çš„roleçš„å¤šå±‚è§£å†³æ–¹æ¡ˆ</li>
</ul>
<hr>
<h2 id="äºŒæ¶æ„">äºŒã€æ¶æ„</h2>
<pre tabindex="0"><code>ç”¨æˆ·/PLAYBOOK =&gt; INVENTORY/API/MODULES/PLUGINS =&gt; HOSTS/NETWORK
INVEMTORY: Ansibleç®¡ç†ä¸»æœºçš„æ¸…å• /etc/ansible/hosts
MODULES: Ansibleæ‰§è¡Œå‘½ä»¤çš„åŠŸèƒ½æ¨¡å—ã€å¤šæ•°ä¸ºå†…ç½®æ ¸å¿ƒæ¨¡å—ï¼Œä¹Ÿå¯ä»¥è‡ªå®šä¹‰
PLUGINS: æ¨¡å—åŠŸèƒ½çš„è¡¥å……ï¼Œå¦‚è¿æ¥ç±»å‹æ’ä»¶ã€å¾ªç¯æ’ä»¶ã€å˜é‡æ’ä»¶ã€è¿‡æ»¤æ’ä»¶ç­‰
API: ä¾›ç¬¬ä¸‰æ–¹ç¨‹åºè°ƒç”¨çš„åº”ç”¨ç¨‹åºæ¥å£
</code></pre><h2 id="ç”¨æˆ·ç›´æ¥ä½¿ç”¨å‘½ä»¤æˆ–è€…ä½¿ç”¨-playbook-æˆ–è€…-è°ƒç”¨api-å»è¿œç¨‹ä¸»æœºæ‰§è¡Œå‘½ä»¤">ç”¨æˆ·ç›´æ¥ä½¿ç”¨å‘½ä»¤æˆ–è€…ä½¿ç”¨ Playbook æˆ–è€… è°ƒç”¨API å»è¿œç¨‹ä¸»æœºæ‰§è¡Œå‘½ä»¤</h2>
<h2 id="ä¸‰æ³¨æ„äº‹é¡¹">ä¸‰ã€æ³¨æ„äº‹é¡¹</h2>
<ul>
<li>æ‰§è¡Œansibleçš„ä¸»æœºä¸€èˆ¬ç§°ä¸ºä¸»æ§ç«¯ï¼Œä¸­æ§ï¼Œmasteræˆ–å ¡å’æœº</li>
<li>ä¸»æ§æ®µpythonéœ€è¦åœ¨2.6æˆ–ä»¥ä¸Š</li>
<li>è¢«æ§ç«¯pythonç‰ˆæœ¬å°é±¼2.4çš„éœ€è¦å®‰è£… python-simplejson</li>
<li>windowsä¸èƒ½ä½œä¸ºä¸»æ§</li>
</ul>
<hr>
<h2 id="å››å®‰è£…">å››ã€å®‰è£…</h2>
<ul>
<li>epelæºrpmåŒ…å®‰è£…</li>
</ul>
<p><code>sudo yum -y install epel-release &amp;&amp; sudo yum -y install ansible</code></p>
<ul>
<li>
<p><a href="https://docs.ansible.com/ansible/latest/installation_guide/intro_installation.html">å®˜æ–¹å…¶ä»–å®‰è£…æ–¹å¼</a></p>
</li>
<li>
<p>æŸ¥çœ‹å®‰è£…ç‰ˆæœ¬å’Œå‘½ä»¤</p>
</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>ansible --version
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>ansible 2.9.27
</span></span><span style="display:flex;"><span>  config file = /etc/ansible/ansible.cfg
</span></span><span style="display:flex;"><span>  configured module search path = [u&#39;/root/.ansible/plugins/modules&#39;, u&#39;/usr/share/ansible/plugins/modules&#39;]
</span></span><span style="display:flex;"><span>  ansible python module location = /usr/lib/python2.7/site-packages/ansible
</span></span><span style="display:flex;"><span>  executable location = /usr/bin/ansible
</span></span><span style="display:flex;"><span>  python version = 2.7.5 (default, Nov 16 2020, 22:23:17) [GCC 4.8.5 20150623 (Red Hat 4.8.5-44)]
</span></span></code></pre></div><p><code>rpm -ql ansible</code> å¯ä»¥æŸ¥çœ‹ansibleéƒ½ä¸‹è½½äº†å“ªäº›æ–‡ä»¶ã€‚
ä¹Ÿå¯ä»¥åœ¨ç»ˆç«¯è¾“å…¥ansible å<!-- raw HTML omitted -->Tab<!-- raw HTML omitted --> é”®æŸ¥çœ‹è¾“å‡ºçš„å‘½ä»¤</p>
<hr>
<h2 id="äº”åŸºæœ¬ä½¿ç”¨">äº”ã€åŸºæœ¬ä½¿ç”¨</h2>
<h3 id="å‡†å¤‡æœºå™¨">å‡†å¤‡æœºå™¨</h3>
<table>
<thead>
<tr>
<th>èŠ‚ç‚¹åç§°</th>
<th>èŠ‚ç‚¹IP</th>
<th>è§’è‰²</th>
</tr>
</thead>
<tbody>
<tr>
<td>k8s-master-001</td>
<td>10.241.12.3</td>
<td>Ansible-Server</td>
</tr>
<tr>
<td>k8s-master-003</td>
<td>10.241.12.1</td>
<td>è¢«æ§åˆ¶ç«¯</td>
</tr>
<tr>
<td>k8s-master-002</td>
<td>10.241.12.2</td>
<td>è¢«æ§åˆ¶ç«¯</td>
</tr>
<tr>
<td>k8s-node-003</td>
<td>10.241.12.9</td>
<td>è¢«æ§åˆ¶ç«¯</td>
</tr>
<tr>
<td>k8s-node-001</td>
<td>10.241.12.12</td>
<td>è¢«æ§åˆ¶ç«¯</td>
</tr>
</tbody>
</table>
<h3 id="anisbleç®¡ç†ä¸»æœºçš„æ–¹å¼">anisbleç®¡ç†ä¸»æœºçš„æ–¹å¼</h3>
<ul>
<li>Ad-HC å³åˆ©ç”¨ansibleå‘½ä»¤ï¼Œä¸»è¦ç”¨äºä¸´æ—¶å‘½ä»¤åœºæ™¯</li>
<li>Ansible-playbook ä¸»è¦ç”¨äºé•¿æœŸè§„åˆ’å¥½çš„ï¼Œå¤§å‹é¡¹ç›®çš„ä½¿ç”¨ï¼Œéœ€è¦æœ‰å‰æœŸçš„è§„åˆ’è¿‡ç¨‹ã€‚</li>
</ul>
<h3 id="é…ç½®æ–‡ä»¶">é…ç½®æ–‡ä»¶</h3>
<ul>
<li>/etc/ansible/ansible.cfg #ä¸»é…ç½®æ–‡ä»¶ï¼Œé…ç½®ansibleå·¥ä½œ
<pre tabindex="0"><code>[defaults]
inventory = /etc/ansible/hosts #ä¸»æœºåˆ—è¡¨
library = /usr/share/my_modules #åº“æ–‡ä»¶å­˜æ”¾ç›®å½•
remote_tmp = $HOME/.ansible/tmp #ä¸´æ—¶ py å‘½ä»¤æ–‡ä»¶å­˜æ”¾åœ¨è¿œç¨‹ä¸»æœºç›®å½•
local_tmp = $HOME/.ansible/tmp #æœ¬æœºçš„ä¸´æ—¶å‘½ä»¤æ‰§è¡Œç›®å½•
forks = 5 #é»˜è®¤å¹¶å‘æ•°é‡
sudo_user = root #é»˜è®¤sudoç”¨æˆ·
ask_sudo_pass = True #æ¯æ¬¡æ‰§è¡Œansible å‘½ä»¤æ˜¯å¦è¯¢é—®sshå¯†ç 
ask_pass = True
remote_port =22
host_key_checking = False #æ£€æŸ¥å¯¹åº”æœåŠ¡å™¨çš„host_key, å»ºè®®å–æ¶ˆæ³¨é‡Š
log_path = /var/log/ansible.log #æ—¥å¿—æ–‡ä»¶ å»ºè®®å¯ç”¨
module_name = command #é»˜è®¤æ¨¡å—ï¼Œå¯ä»¥ä¿®æ”¹ä¸ºshellæ¨¡å— 
</code></pre></li>
<li>/etc/ansible/hosts #ä¸»æœºæ¸…å•
ä¸ºäº†æ‰¹é‡å¿«æ·çš„ç®¡ç†éƒ¨åˆ†ä¸»æœº
<pre tabindex="0"><code>#ä¸¾ä¾‹å­
#[æ ‡ç­¾å]
#ip1
#ip2
#ip3:222
#å°†ä¸‹é¢çš„é…ç½®å†™å…¥ /etc/ansible/hosts
[k8s-master]
#k8s-master-003
10.241.12.1
#k8s-master-002
10.241.12.2
[k8s-slave]
#k8s-node-003
10.241.12.9
#k8s-node-001
10.241.12.12
</code></pre></li>
<li>/etc/ansible/role #å­˜æ”¾è§’è‰²</li>
</ul>
<h3 id="ansible-doc-å‘½ä»¤æ–‡æ¡£">ansible-doc å‘½ä»¤æ–‡æ¡£</h3>
<p>æ­¤å‘½ä»¤ç”¨æ¥æ˜¾ç¤ºæ¨¡å—çš„å¸®åŠ©æ–‡æ¡£
æ ¼å¼</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>ansible-doc [OPTION] [MODULE...]
</span></span><span style="display:flex;"><span>-l , --list #åˆ—å‡ºå¯ç”¨æ¨¡å—
</span></span><span style="display:flex;"><span>-s , --snippet #æ˜¾ç¤ºæŒ‡å®šæ¨¡å—çš„playbookç‰‡æ®µ
</span></span><span style="display:flex;"><span>ä¾‹å­
</span></span><span style="display:flex;"><span>ansible-doc -s ping
</span></span></code></pre></div><h3 id="ansible-å‘½ä»¤">ansible å‘½ä»¤</h3>
<p>ä½¿ç”¨SSHåè®®å®ç°å¯¹è¿œç¨‹ä¸»æœºçš„é…ç½®ã€‚ æ‰€ä»¥ä¸»æ§ç«¯éœ€è¦èƒ½åŸºäºå¯†é’¥è®¤è¯çš„æ–¹å¼è”ç³»å“¥å“¥è¢«ç®¡ç†èŠ‚ç‚¹</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e">#ä¾‹å¦‚ä½¿ç”¨sshpassæ‰¹é‡å®ç°keyçš„éªŒè¯</span>
</span></span><span style="display:flex;"><span>ssh-keygen -f /root/.ssh/id_rsa -P <span style="color:#e6db74">&#39;&#39;</span>
</span></span><span style="display:flex;"><span>NET<span style="color:#f92672">=</span> 192.168.100
</span></span><span style="display:flex;"><span>export SSHPASS<span style="color:#f92672">=</span>xxxx
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> IP in <span style="color:#f92672">{</span>1..200<span style="color:#f92672">}</span>;<span style="color:#66d9ef">do</span>
</span></span><span style="display:flex;"><span>  sshpass -e ssh-copy-id $NET.$IP
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">done</span>
</span></span></code></pre></div><h4 id="æ ¼å¼">æ ¼å¼</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ansible &lt;host_pattern&gt; <span style="color:#f92672">[</span> -m module_name<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>-a args<span style="color:#f92672">]</span>
</span></span></code></pre></div><h4 id="é‡è¦é€‰é¡¹è¯´æ˜">é‡è¦é€‰é¡¹è¯´æ˜</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>--version #æ˜¾ç¤ºç‰ˆæœ¬
</span></span><span style="display:flex;"><span>-m moudle #æŒ‡å®šæ¨¡å—ï¼Œé»˜è®¤ä¸ºcommand
</span></span><span style="display:flex;"><span>-v #è¯¦ç»†è¿‡ç¨‹ -vv -vvv æ›´åŠ è¯¦ç»†
</span></span><span style="display:flex;"><span>--list-hosts #åˆ—å‡ºä¸»æœºåˆ—è¡¨
</span></span><span style="display:flex;"><span>-k, --ask-pass #æç¤ºè¾“å…¥sshè¿æ¥å¯†ç ï¼Œé»˜è®¤keyéªŒè¯
</span></span><span style="display:flex;"><span>-C, --check #æ£€æŸ¥ï¼Œå¹¶ä¸æ‰§è¡Œ
</span></span><span style="display:flex;"><span>-T, --timeout=TIMEOUT #æ‰§è¡Œè¿œç¨‹å‘½ä»¤çš„ç”¨æˆ·,é»˜è®¤10S
</span></span><span style="display:flex;"><span>-uï¼Œ--user=PEMOTE_USER #æ‰§è¡Œå›­é•¿æ‰§è¡Œçš„ç”¨æˆ·
</span></span><span style="display:flex;"><span>-b, --become #ä»£æ›¿æ—§ç‰ˆçš„sudo åˆ‡æ¢
</span></span><span style="display:flex;"><span>--beconme-user=USERNAME #æŒ‡å®šsudoçš„runasç”¨æˆ·ï¼Œé»˜è®¤ä¸ºroot
</span></span><span style="display:flex;"><span>-K, --ask-becomne-pass #æç¤ºè¾“å…¥sudoæ—¶çš„å£ä»¤
</span></span></code></pre></div><p>ä¸¾ä¾‹ä½¿ç”¨pingæ¨¡å—</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span># ansible all -m ping æˆ–è€…  ansible k8s-master#è¿™é‡ŒæŒ‡å®šäº†hostsé‡Œå†™çš„æ ‡ç­¾ç»„ -m ping
</span></span><span style="display:flex;"><span>[WARNING]: Invalid characters were found in group names but not replaced, use -vvvv to see details
</span></span><span style="display:flex;"><span>10.241.12.1 | SUCCESS =&gt; {
</span></span><span style="display:flex;"><span>    &#34;ansible_facts&#34;: {
</span></span><span style="display:flex;"><span>        &#34;discovered_interpreter_python&#34;: &#34;/usr/bin/python&#34;
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    &#34;changed&#34;: false,
</span></span><span style="display:flex;"><span>    &#34;ping&#34;: &#34;pong&#34;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>10.241.12.12 | SUCCESS =&gt; {
</span></span><span style="display:flex;"><span>    &#34;ansible_facts&#34;: {
</span></span><span style="display:flex;"><span>        &#34;discovered_interpreter_python&#34;: &#34;/usr/bin/python&#34;
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    &#34;changed&#34;: false,
</span></span><span style="display:flex;"><span>    &#34;ping&#34;: &#34;pong&#34;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>10.241.12.2 | SUCCESS =&gt; {
</span></span><span style="display:flex;"><span>    &#34;ansible_facts&#34;: {
</span></span><span style="display:flex;"><span>        &#34;discovered_interpreter_python&#34;: &#34;/usr/bin/python&#34;
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    &#34;changed&#34;: false,
</span></span><span style="display:flex;"><span>    &#34;ping&#34;: &#34;pong&#34;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>10.241.12.9 | SUCCESS =&gt; {
</span></span><span style="display:flex;"><span>    &#34;ansible_facts&#34;: {
</span></span><span style="display:flex;"><span>        &#34;discovered_interpreter_python&#34;: &#34;/usr/bin/python&#34;
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    &#34;changed&#34;: false,
</span></span><span style="display:flex;"><span>    &#34;ping&#34;: &#34;pong&#34;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>å¦‚æœæ²¡æœ‰éªŒè¯é€šè¿‡ï¼Œéœ€è¦ -k æ¥è¾“å…¥å¯†ç ï¼Œå¾ˆéº»çƒ¦ã€‚æ‰€ä»¥å»ºè®®ä½¿ç”¨ç§˜é’¥ã€‚</p>
<h3 id="é€‰æ‹©ç‰¹å®šä¸»æœº">é€‰æ‹©ç‰¹å®šä¸»æœº</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>[root@k8s-master-001 ~]# ansible all --list-hosts
</span></span><span style="display:flex;"><span>[WARNING]: Invalid characters were found in group names but not replaced, use -vvvv to see details
</span></span><span style="display:flex;"><span>  hosts (4):
</span></span><span style="display:flex;"><span>    10.241.12.9
</span></span><span style="display:flex;"><span>    10.241.12.12
</span></span><span style="display:flex;"><span>    10.241.12.1
</span></span><span style="display:flex;"><span>    10.241.12.2
</span></span><span style="display:flex;"><span>#æˆ–è€…æŒ‡å®šæ ‡ç­¾ç»„
</span></span><span style="display:flex;"><span>[root@k8s-master-001 ~]# ansible k8s-master --list-hosts
</span></span><span style="display:flex;"><span>[WARNING]: Invalid characters were found in group names but not replaced, use -vvvv to see details
</span></span><span style="display:flex;"><span>  hosts (2):
</span></span><span style="display:flex;"><span>    10.241.12.1
</span></span><span style="display:flex;"><span>    10.241.12.2
</span></span></code></pre></div><p>ä½¿ç”¨é€šé…ç¬¦æŒ‡å®šä¸»æœº</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>ansible &#39;*&#39; --list-hosts
</span></span><span style="display:flex;"><span>ansible 10.241.* --list-hosts
</span></span><span style="display:flex;"><span>ansible 10.241.12.1:10.241.12.2 --list-hosts #ä¿©ä¸ªæœºå™¨ä¸­çš„ä¸€ä¸ª ï¼Œæˆ–è€…å…³ç³»
</span></span><span style="display:flex;"><span>ansible &#39;k8s-master:&amp;k8s-node&#39; --list-hosts #ä¸çš„å…³ç³»ï¼Œåœ¨k8s-masteræ ‡ç­¾ç»„é‡Œä¹Ÿåœ¨k8s-nodeé‡Œé¢
</span></span><span style="display:flex;"><span>ansible &#39;k8s-master:!k8s-node&#39; --list-hosts #éå¾—å…³ç³»ï¼Œåœ¨k8s-masteræ ‡ç­¾ç»„é‡Œä½†ä¸åœ¨ k8s-nodeé‡Œé¢
</span></span></code></pre></div><p>æ­£åˆ™è¡¨è¾¾å¼é€‰æ‹©ä¸»æœº</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>ansible &#39;~(k8s-master|k8s-node)&#39; -m ping
</span></span></code></pre></div><h3 id="ansible-æ‰§è¡Œå‘½ä»¤çš„è¿‡ç¨‹">Ansible æ‰§è¡Œå‘½ä»¤çš„è¿‡ç¨‹</h3>
<p>1.åŠ è½½ é»˜è®¤çš„/etc/ansible/ansible.cfg
2.åŠ è½½è‡ªå·±å¯¹åº”çš„æ¨¡å—æ–‡ä»¶ï¼Œå¦‚ command
3.é€šè¿‡ansibleå°†æ¨¡å—æˆ–è€…å‘½ä»¤ç”Ÿæˆå¯¹åº”çš„ä¸´æ—¶pyæ–‡ä»¶ï¼Œå°†æ–‡ä»¶ä¼ è¾“è‡³è¿œç¨‹æœåŠ¡å™¨å¯¹åº”æ‰§è¡Œç”¨æˆ·çš„$HOME/.ansible/tmp/ansible-tmp-æ•°å­—/xxx.py
4.èµ‹äºˆæ‰§è¡Œæƒé™
5.æ‰§è¡Œå¹¶ä¸”è¿”å›ç»“æœ
6.åˆ é™¤pyæ–‡ä»¶ï¼Œé€€å‡º</p>
<h3 id="ansibleæ‰§è¡Œçš„çŠ¶æ€">ansibleæ‰§è¡Œçš„çŠ¶æ€</h3>
<p>åœ¨ /etc/ansible/ansible.cfg çš„ [colers] æ¨¡å—ä¸­æœ‰é¢œè‰²çš„è¯¦ç»†è¯´æ˜</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>[colors]
</span></span><span style="display:flex;"><span>#highlight = white
</span></span><span style="display:flex;"><span>#verbose = blue
</span></span><span style="display:flex;"><span>#warn = bright purple
</span></span><span style="display:flex;"><span>#error = red
</span></span><span style="display:flex;"><span>#debug = dark gray
</span></span><span style="display:flex;"><span>#deprecate = purple
</span></span><span style="display:flex;"><span>#skip = cyan
</span></span><span style="display:flex;"><span>#unreachable = red
</span></span><span style="display:flex;"><span>#ok = green
</span></span><span style="display:flex;"><span>#changed = yellow
</span></span><span style="display:flex;"><span>#diff_add = green
</span></span><span style="display:flex;"><span>#diff_remove = red
</span></span><span style="display:flex;"><span>#diff_lines = cyan
</span></span></code></pre></div><h3 id="ansible-galaxy--ansible-ä½¿ç”¨åˆ«äººä¸‹è½½çš„å·¥å…·">ansible-galaxy # ansible ä½¿ç”¨åˆ«äººä¸‹è½½çš„å·¥å…·</h3>
<p>æ­¤å·¥å…·ä¼šé“¾æ¥ <a href="https://galaxy.ansible.com">https://galaxy.ansible.com</a> ä¸‹è½½å¯¹åº”çš„roles</p>
<p>åˆ—å‡ºå·²ç»å®‰è£…çš„galaxy</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>ansible-galaxy list
</span></span></code></pre></div><p>ä¸‹è½½å¯¹åº”çš„ roles</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>#
</span></span><span style="display:flex;"><span>ansible-galaxy install pogosoftware.etcd
</span></span><span style="display:flex;"><span>#è¿”å›å†…å®¹&#34;
</span></span><span style="display:flex;"><span>#- downloading role &#39;etcd&#39;, owned by pogosoftware
</span></span><span style="display:flex;"><span>#- downloading role from https://github.com/pogosoftware/ansible-role-etcd/archive/v1.0.2.tar.gz
</span></span><span style="display:flex;"><span>#- extracting pogosoftware.etcd to /root/.ansible/roles/pogosoftware.etcd
</span></span><span style="display:flex;"><span>#- pogosoftware.etcd (v1.0.2) was installed successfully
</span></span></code></pre></div><p>æŸ¥çœ‹é‡Œé¢çš„rolesç»“æ„</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span> tree  /root/.ansible/roles/pogosoftware.etcd
</span></span><span style="display:flex;"><span>/root/.ansible/roles/pogosoftware.etcd
</span></span><span style="display:flex;"><span>â”œâ”€â”€ defaults
</span></span><span style="display:flex;"><span>â”‚Â Â  â””â”€â”€ main.yml
</span></span><span style="display:flex;"><span>â”œâ”€â”€ handlers
</span></span><span style="display:flex;"><span>â”‚Â Â  â””â”€â”€ main.yml
</span></span><span style="display:flex;"><span>â”œâ”€â”€ LICENSE
</span></span><span style="display:flex;"><span>â”œâ”€â”€ meta
</span></span><span style="display:flex;"><span>â”‚Â Â  â””â”€â”€ main.yml
</span></span><span style="display:flex;"><span>â”œâ”€â”€ tasks
</span></span><span style="display:flex;"><span>â”‚Â Â  â”œâ”€â”€ etcd_user.yml
</span></span><span style="display:flex;"><span>â”‚Â Â  â””â”€â”€ main.yml
</span></span><span style="display:flex;"><span>â””â”€â”€ templates
</span></span><span style="display:flex;"><span>    â””â”€â”€ etcd.service.j2
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>5 directories, 7 files
</span></span><span style="display:flex;"><span>#å¯ä»¥ cp -a ä¸€ä¸ªæ–‡ä»¶åç§°ç„¶åå†é‡Œé¢æ”¹è‡ªå·±çš„å®šåˆ¶åŒ–éœ€æ±‚
</span></span></code></pre></div><p>åˆ é™¤galaxy</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>ansible-galaxy remove pogosoftware.etcd
</span></span></code></pre></div><hr>
<h3 id="ansible-pull">ansible-pull</h3>
<p>å°†ansibleçš„å‘½ä»¤æ¨é€è‡³è¿œç¨‹</p>
<h3 id="ansible-palybook-åé¢æœ‰è¯¦è§£">ansible-palybook (åé¢æœ‰è¯¦è§£)</h3>
<p>æ­¤å·¥å…·ç”¨äºç¼–å†™å¥½çš„playbookä»»åŠ¡</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>cat hello.yml
</span></span><span style="display:flex;"><span>- hosts: k8s-slave
</span></span><span style="display:flex;"><span>  remote_user: root
</span></span><span style="display:flex;"><span>  tasks:
</span></span><span style="display:flex;"><span>    - name: hello world
</span></span><span style="display:flex;"><span>      command: /usr/bin/wall hello world
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#æ‰§è¡Œçš„æ—¶å€™è®°å¾—æ‰“å¼€ k8s-slaveä¸­çš„ä¸€ä¸ªä¸»æœºç»ˆç«¯çœ‹æ•ˆæœ
</span></span><span style="display:flex;"><span> ansible k8s-slave  --list-host
</span></span><span style="display:flex;"><span> ä¼šå‘ç°ç»ˆç«¯è¾“å‡ºäº† hello  world
</span></span></code></pre></div><h3 id="ansible-vault-åŠ å¯†ymlæ–‡ä»¶">ansible-vault åŠ å¯†ymlæ–‡ä»¶</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>ansible-vaut encrypt hello.yml #åŠ å¯† ä¼šè®©è¾“å…¥åŠ å¯†å£ä»¤
</span></span><span style="display:flex;"><span>ansible-vaut decrypt hello.yml #è§£å¯†
</span></span><span style="display:flex;"><span>ansiblt-vault view hello.yml #æŸ¥çœ‹
</span></span><span style="display:flex;"><span>ansible-vault edit hello.yml #ç¼–è¾‘åŠ å¯†æ–‡ä»¶
</span></span><span style="display:flex;"><span>ansiblt-vault rekey hello.yml #ä¿®æ”¹å£ä»¤
</span></span><span style="display:flex;"><span>ansiblt-vault create new.yml #åˆ›å»ºæ–°æ–‡ä»¶
</span></span></code></pre></div><h3 id="ansible-console-å¯äº¤äº’å‘½ä»¤">ansible-console å¯äº¤äº’å‘½ä»¤</h3>
<p>æ”¯æŒtab
æç¤ºç¬¦å·æ ¼å¼ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>æ‰§è¡Œç”¨æˆ·@å½“å‰æ“ä½œä¸»æœºç»„ï¼ˆå½“æœŸä¸»æœºç»„çš„ä¸»æœºæ•°é‡ï¼‰[f:å¹¶å‘æ•°]$
</span></span></code></pre></div><p>å¸¸ç”¨å­å‘½ä»¤ï¼š</p>
<ul>
<li>è®¾ç½®å¹¶å‘æ•°é‡ï¼šforks n ä¾‹å¦‚ forks 10</li>
<li>åˆ‡æ¢ç»„ï¼š cd ä¸»æœºç»„ ä¾‹å¦‚ cd web</li>
<li>åˆ—å‡ºå½“å‰ä¸»æœºç»„ä¾‹å¦‚ list</li>
<li>åˆ—å‡ºæ‰€æœ‰çš„å†…ç½®å‘½ä»¤ï¼š ï¼Ÿ æˆ–è€…help</li>
</ul>
<p>ä¾‹å­</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>ansible-console
</span></span><span style="display:flex;"><span>[WARNING]: Invalid characters were found in group names but not replaced, use -vvvv to see details
</span></span><span style="display:flex;"><span>Welcome to the ansible console.
</span></span><span style="display:flex;"><span>Type help or ? to list commands.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>root@all (4)[f:5]$ cd k8s-master
</span></span><span style="display:flex;"><span>root@k8s-master (2)[f:5]$ list
</span></span><span style="display:flex;"><span>10.241.12.1
</span></span><span style="display:flex;"><span>10.241.12.2
</span></span><span style="display:flex;"><span>root@k8s-master (2)[f:5]$ yum name=lftp
</span></span><span style="display:flex;"><span>10.241.12.1 | SUCCESS =&gt; {
</span></span><span style="display:flex;"><span>    &#34;ansible_facts&#34;: {
</span></span><span style="display:flex;"><span>        &#34;discovered_interpreter_python&#34;: &#34;/usr/bin/python&#34;
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    &#34;changed&#34;: false,
</span></span><span style="display:flex;"><span>    &#34;msg&#34;: &#34;&#34;,
</span></span><span style="display:flex;"><span>    &#34;rc&#34;: 0,
</span></span><span style="display:flex;"><span>    &#34;results&#34;: [
</span></span><span style="display:flex;"><span>        &#34;lftp-4.4.8-12.el7_8.1.x86_64 providing lftp is already installed&#34;
</span></span><span style="display:flex;"><span>    ]
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>...
</span></span></code></pre></div><h2 id="å…­ansible-å¸¸ç”¨æ¨¡å—">å…­ã€Ansible å¸¸ç”¨æ¨¡å—</h2>
<h3 id="command-æ¨¡å—">Command æ¨¡å—</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"></code></pre></div>
        </article>
    </div>

    
       	






<div id="comments" class="post-comments">
  <div class="comment-head">
    <div class="comment-headline">
      <i class="fa fa-comments fa-fw"></i>
      
    </div>
  
  </div>
  <div class="comment-wrap">
  
  
    <div>      
      <div class="comment-loading">
    <i class="fa fa-sync fa-spin"></i>
  </div>
      <div class="waline-container"></div>

    </div>
  
  </div>
</div>  

    
</div><aside class="Qc_aside">

<section class="Qc_aside_item tags"> 
    <div class="Qc_aside_item-title"> 
        <i class="iconfont icon-A67" style="margin-right: 8px;font-size: 17px"></i> 
        <span class="text">æ–‡ç« åˆ†ç±»</span> 
        <span class="qccq_mac"></span> 
    </div> 
    <div class="Qc_aside_item-contain" style="padding:10px"> 
        <div class="tag"></div> 
		<ul class="list">
			
			
			   
			<li class="item"> 
				<a class="link" href="/categories/%E4%B8%AA%E4%BA%BA%E9%9A%8F%E7%AC%94/">ä¸ªäººéšç¬” </a>
				<span class="widget__counter widget__counter--bubble">1</span>
			</li>
	</div>
</section>




<section class="Qc_aside_item tags"> 
    <div class="Qc_aside_item-title"> 
        <i class="iconfont icon-A67" style="margin-right: 8px;font-size: 17px"></i> 
        <span class="text">æ ‡ç­¾äº‘</span> 
        <span class="xccx_mac"></span> 
    </div> 
     <div class="Qc_aside_item-contain" style="padding:10px"> 
        <div class="tag"></div> 
        <ul class="cloud">
         </ul> 
        </div> 
    </section>



    

    <section class="sticky_layout"><style>

    .card-widget:first-child {
        margin-top: 0
    }

    @media screen and (max-width:900px) {
        .card-widget:first-child {
            margin-top: 20px
        }
    }

     .card-widget {
        position: relative;
        overflow: hidden;
        margin-top: 20px;
        padding: 20px 24px;
        color:var(--main)
    }

     .card-widget,
    #recent-posts>.recent-post-item,
    .cardHover,
    .error404 #error-wrap .error-content,
    .layout>.recent-posts .pagination>:not(.space),
    .layout>div:first-child:not(.recent-posts) {
        border-radius: 8px;
        background: var(--background);
        -webkit-box-shadow: var(--card-box-shadow);
        box-shadow: var(--card-box-shadow);
        -webkit-transition: all .3s;
        -moz-transition: all .3s;
        -o-transition: all .3s;
        -ms-transition: all .3s;
        transition: all .3s
    }

    .card-widget:hover,
    #recent-posts>.recent-post-item:hover,
    .cardHover:hover,
    .error404 #error-wrap .error-content:hover,
    .layout>.recent-posts .pagination>:not(.space):hover,
    .layout>div:first-child:not(.recent-posts):hover {
        -webkit-box-shadow: var(--card-hover-box-shadow);
        box-shadow: var(--card-hover-box-shadow)
    }



    .item-headline {
        padding-bottom: 6px;
        font-size: 1.2em
    }

     .item-headline span {
        margin-left: 6px
    }

   
 
     @media screen and (min-width:900px) {
        .sticky_layout {
            position: sticky;
            position: -webkit-sticky;
            top: 60px;
            -webkit-transition: top .3s;
            -moz-transition: top .3s;
            -o-transition: top .3s;
            -ms-transition: top .3s;
            transition: top .3s
        }
    } 

    



    #card-toc .toc-percentage {
        float: right;
        margin-top: -9px;
        color: #a9a9a9;
        font-style: italic;
        font-size: 140%
    }

    #card-toc .toc-content {
        overflow-y: scroll;
        overflow-y: overlay;
        margin: 0 -24px;
        max-height: calc(100vh - 120px)
    }

    @media screen and (max-width:900px) {
         #card-toc .toc-content {
            max-height: calc(100vh - 140px)
        }
    }

     #card-toc .toc-content>* {
        margin: 0 20px !important
    }



     #card-toc .toc-content>*>.toc-item>.toc-child {
        margin-left: 10px;
        padding-left: 10px;
        border-left: 1px solid var(--dark-grey)
    }

    #card-toc .toc-content:not(.is-expand) .toc-child {
        display: none
    }

    @media screen and (max-width:900px) {
        #card-toc .toc-content:not(.is-expand) .toc-child {
            display: block !important
        }
    }

   #card-toc .toc-content:not(.is-expand) .toc-item.active .toc-child {
        display: block
    }

    #card-toc .toc-content li,
     #card-toc .toc-content ol {
        list-style: none
    }

     #card-toc .toc-content>ol {
        padding: 0 !important
    }

    #card-toc .toc-content ol {
        margin: 0;
        padding-left: 18px
    }

    #card-toc .toc-content .toc-link {
        display: block;
        margin: 4px 0;
        padding: 1px 6px;
        color: var(--toc-link-color);
        -webkit-transition: all .2s ease-in-out;
        -moz-transition: all .2s ease-in-out;
        -o-transition: all .2s ease-in-out;
        -ms-transition: all .2s ease-in-out;
        transition: all .2s ease-in-out
    }

     #card-toc .toc-content .toc-link:hover {
        color: #49b1f5
    }

    #card-toc .toc-content .toc-link.active {
        background: #00c4b6;
        color: #fff
    }

     .sticky_layout:only-child>:first-child {
        margin-top: 20px
    }


</style><div class="card-widget" id="card-toc">
        <div class="item-headline">
            <i class="fa fa-bars"></i>
            <span>ç›®å½•</span>
            <span class="toc-percentage">0</span>
        </div>
        <div class="toc-content"><ol class="toc">
                        <li class="toc-item toc-level-3">
                            <a class="toc-link" href="#ansible" aria-label="Ansible" data-pjax-state="anchor">
                                <span class="toc-number">1</span> 
                                <span class="toc-text">Ansible</span>
                            </a><ol class="toc-child">

                    <li class="toc-item toc-level-2">
                        <a class="toc-link" href="#%e4%b8%80%e7%89%b9%e7%82%b9" aria-label="ä¸€ã€ç‰¹ç‚¹" data-pjax-state="anchor">
                            <span class="toc-number">2</span> 
                            <span class="toc-text">ä¸€ã€ç‰¹ç‚¹</span>
                        </a></li>

                    <li class="toc-item toc-level-2">
                        <a class="toc-link" href="#%e4%ba%8c%e6%9e%b6%e6%9e%84" aria-label="äºŒã€æ¶æ„" data-pjax-state="anchor">
                            <span class="toc-number">2</span> 
                            <span class="toc-text">äºŒã€æ¶æ„</span>
                        </a></li>

                    <li class="toc-item toc-level-2">
                        <a class="toc-link" href="#%e7%94%a8%e6%88%b7%e7%9b%b4%e6%8e%a5%e4%bd%bf%e7%94%a8%e5%91%bd%e4%bb%a4%e6%88%96%e8%80%85%e4%bd%bf%e7%94%a8-playbook-%e6%88%96%e8%80%85-%e8%b0%83%e7%94%a8api-%e5%8e%bb%e8%bf%9c%e7%a8%8b%e4%b8%bb%e6%9c%ba%e6%89%a7%e8%a1%8c%e5%91%bd%e4%bb%a4" aria-label="ç”¨æˆ·ç›´æ¥ä½¿ç”¨å‘½ä»¤æˆ–è€…ä½¿ç”¨ Playbook æˆ–è€… è°ƒç”¨API å»è¿œç¨‹ä¸»æœºæ‰§è¡Œå‘½ä»¤" data-pjax-state="anchor">
                            <span class="toc-number">2</span> 
                            <span class="toc-text">ç”¨æˆ·ç›´æ¥ä½¿ç”¨å‘½ä»¤æˆ–è€…ä½¿ç”¨ Playbook æˆ–è€… è°ƒç”¨API å»è¿œç¨‹ä¸»æœºæ‰§è¡Œå‘½ä»¤</span>
                        </a></li>

                    <li class="toc-item toc-level-2">
                        <a class="toc-link" href="#%e4%b8%89%e6%b3%a8%e6%84%8f%e4%ba%8b%e9%a1%b9" aria-label="ä¸‰ã€æ³¨æ„äº‹é¡¹" data-pjax-state="anchor">
                            <span class="toc-number">2</span> 
                            <span class="toc-text">ä¸‰ã€æ³¨æ„äº‹é¡¹</span>
                        </a></li>

                    <li class="toc-item toc-level-2">
                        <a class="toc-link" href="#%e5%9b%9b%e5%ae%89%e8%a3%85" aria-label="å››ã€å®‰è£…" data-pjax-state="anchor">
                            <span class="toc-number">2</span> 
                            <span class="toc-text">å››ã€å®‰è£…</span>
                        </a></li>

                    <li class="toc-item toc-level-2">
                        <a class="toc-link" href="#%e4%ba%94%e5%9f%ba%e6%9c%ac%e4%bd%bf%e7%94%a8" aria-label="äº”ã€åŸºæœ¬ä½¿ç”¨" data-pjax-state="anchor">
                            <span class="toc-number">2</span> 
                            <span class="toc-text">äº”ã€åŸºæœ¬ä½¿ç”¨</span>
                        </a><ol class="toc-child">

                    <li class="toc-item toc-level-2">
                        <a class="toc-link" href="#%e5%87%86%e5%a4%87%e6%9c%ba%e5%99%a8" aria-label="å‡†å¤‡æœºå™¨" data-pjax-state="anchor">
                            <span class="toc-number">3</span> 
                            <span class="toc-text">å‡†å¤‡æœºå™¨</span>
                        </a></li>

                    <li class="toc-item toc-level-2">
                        <a class="toc-link" href="#anisble%e7%ae%a1%e7%90%86%e4%b8%bb%e6%9c%ba%e7%9a%84%e6%96%b9%e5%bc%8f" aria-label="anisbleç®¡ç†ä¸»æœºçš„æ–¹å¼" data-pjax-state="anchor">
                            <span class="toc-number">3</span> 
                            <span class="toc-text">anisbleç®¡ç†ä¸»æœºçš„æ–¹å¼</span>
                        </a></li>

                    <li class="toc-item toc-level-2">
                        <a class="toc-link" href="#%e9%85%8d%e7%bd%ae%e6%96%87%e4%bb%b6" aria-label="é…ç½®æ–‡ä»¶" data-pjax-state="anchor">
                            <span class="toc-number">3</span> 
                            <span class="toc-text">é…ç½®æ–‡ä»¶</span>
                        </a></li>

                    <li class="toc-item toc-level-2">
                        <a class="toc-link" href="#ansible-doc-%e5%91%bd%e4%bb%a4%e6%96%87%e6%a1%a3" aria-label="ansible-doc å‘½ä»¤æ–‡æ¡£" data-pjax-state="anchor">
                            <span class="toc-number">3</span> 
                            <span class="toc-text">ansible-doc å‘½ä»¤æ–‡æ¡£</span>
                        </a></li>

                    <li class="toc-item toc-level-2">
                        <a class="toc-link" href="#ansible-%e5%91%bd%e4%bb%a4" aria-label="ansible å‘½ä»¤" data-pjax-state="anchor">
                            <span class="toc-number">3</span> 
                            <span class="toc-text">ansible å‘½ä»¤</span>
                        </a><ol class="toc-child">

                    <li class="toc-item toc-level-2">
                        <a class="toc-link" href="#%e6%a0%bc%e5%bc%8f" aria-label="æ ¼å¼" data-pjax-state="anchor">
                            <span class="toc-number">4</span> 
                            <span class="toc-text">æ ¼å¼</span>
                        </a></li>

                    <li class="toc-item toc-level-2">
                        <a class="toc-link" href="#%e9%87%8d%e8%a6%81%e9%80%89%e9%a1%b9%e8%af%b4%e6%98%8e" aria-label="é‡è¦é€‰é¡¹è¯´æ˜" data-pjax-state="anchor">
                            <span class="toc-number">4</span> 
                            <span class="toc-text">é‡è¦é€‰é¡¹è¯´æ˜</span>
                        </a></li></ol>
                        </li>

                    <li class="toc-item toc-level-2">
                        <a class="toc-link" href="#%e9%80%89%e6%8b%a9%e7%89%b9%e5%ae%9a%e4%b8%bb%e6%9c%ba" aria-label="é€‰æ‹©ç‰¹å®šä¸»æœº" data-pjax-state="anchor">
                            <span class="toc-number">3</span> 
                            <span class="toc-text">é€‰æ‹©ç‰¹å®šä¸»æœº</span>
                        </a></li>

                    <li class="toc-item toc-level-2">
                        <a class="toc-link" href="#ansible-%e6%89%a7%e8%a1%8c%e5%91%bd%e4%bb%a4%e7%9a%84%e8%bf%87%e7%a8%8b" aria-label="Ansible æ‰§è¡Œå‘½ä»¤çš„è¿‡ç¨‹" data-pjax-state="anchor">
                            <span class="toc-number">3</span> 
                            <span class="toc-text">Ansible æ‰§è¡Œå‘½ä»¤çš„è¿‡ç¨‹</span>
                        </a></li>

                    <li class="toc-item toc-level-2">
                        <a class="toc-link" href="#ansible%e6%89%a7%e8%a1%8c%e7%9a%84%e7%8a%b6%e6%80%81" aria-label="ansibleæ‰§è¡Œçš„çŠ¶æ€" data-pjax-state="anchor">
                            <span class="toc-number">3</span> 
                            <span class="toc-text">ansibleæ‰§è¡Œçš„çŠ¶æ€</span>
                        </a></li>

                    <li class="toc-item toc-level-2">
                        <a class="toc-link" href="#ansible-galaxy--ansible-%e4%bd%bf%e7%94%a8%e5%88%ab%e4%ba%ba%e4%b8%8b%e8%bd%bd%e7%9a%84%e5%b7%a5%e5%85%b7" aria-label="ansible-galaxy # ansible ä½¿ç”¨åˆ«äººä¸‹è½½çš„å·¥å…·" data-pjax-state="anchor">
                            <span class="toc-number">3</span> 
                            <span class="toc-text">ansible-galaxy # ansible ä½¿ç”¨åˆ«äººä¸‹è½½çš„å·¥å…·</span>
                        </a></li>

                    <li class="toc-item toc-level-2">
                        <a class="toc-link" href="#ansible-pull" aria-label="ansible-pull" data-pjax-state="anchor">
                            <span class="toc-number">3</span> 
                            <span class="toc-text">ansible-pull</span>
                        </a></li>

                    <li class="toc-item toc-level-2">
                        <a class="toc-link" href="#ansible-palybook-%e5%90%8e%e9%9d%a2%e6%9c%89%e8%af%a6%e8%a7%a3" aria-label="ansible-palybook (åé¢æœ‰è¯¦è§£)" data-pjax-state="anchor">
                            <span class="toc-number">3</span> 
                            <span class="toc-text">ansible-palybook (åé¢æœ‰è¯¦è§£)</span>
                        </a></li>

                    <li class="toc-item toc-level-2">
                        <a class="toc-link" href="#ansible-vault-%e5%8a%a0%e5%af%86yml%e6%96%87%e4%bb%b6" aria-label="ansible-vault åŠ å¯†ymlæ–‡ä»¶" data-pjax-state="anchor">
                            <span class="toc-number">3</span> 
                            <span class="toc-text">ansible-vault åŠ å¯†ymlæ–‡ä»¶</span>
                        </a></li>

                    <li class="toc-item toc-level-2">
                        <a class="toc-link" href="#ansible-console-%e5%8f%af%e4%ba%a4%e4%ba%92%e5%91%bd%e4%bb%a4" aria-label="ansible-console å¯äº¤äº’å‘½ä»¤" data-pjax-state="anchor">
                            <span class="toc-number">3</span> 
                            <span class="toc-text">ansible-console å¯äº¤äº’å‘½ä»¤</span>
                        </a></li></ol>
                        </li>

                    <li class="toc-item toc-level-2">
                        <a class="toc-link" href="#%e5%85%adansible-%e5%b8%b8%e7%94%a8%e6%a8%a1%e5%9d%97" aria-label="å…­ã€Ansible å¸¸ç”¨æ¨¡å—" data-pjax-state="anchor">
                            <span class="toc-number">2</span> 
                            <span class="toc-text">å…­ã€Ansible å¸¸ç”¨æ¨¡å—</span>
                        </a><ol class="toc-child">

                    <li class="toc-item toc-level-2">
                        <a class="toc-link" href="#command-%e6%a8%a1%e5%9d%97" aria-label="Command æ¨¡å—" data-pjax-state="anchor">
                            <span class="toc-number">3</span> 
                            <span class="toc-text">Command æ¨¡å—</span>
                        </a>
                    </li>
                </ol>
                </li>
                </ol>
                </li>
            </ol>

        </div>
    </div>





<script>

    const btf = {
    
        scrollToDest: (pos, time = 500) => {
            const currentPos = window.pageYOffset
            if (currentPos > pos) pos = pos - 70
        
            if ('scrollBehavior' in document.documentElement.style) {
                window.scrollTo({
                top: pos,
                behavior: 'smooth'
                })
                return
            }
        
            let start = null
            pos = +pos
            window.requestAnimationFrame(function step (currentTime) {
                start = !start ? currentTime : start
                const progress = currentTime - start
                if (currentPos < pos) {
                window.scrollTo(0, ((pos - currentPos) * progress / time) + currentPos)
                } else {
                window.scrollTo(0, currentPos - ((currentPos - pos) * progress / time))
                }
                if (progress < time) {
                window.requestAnimationFrame(step)
                } else {
                window.scrollTo(0, pos)
                }
            })
        },
    
       
        getEleTop: ele => {
            let actualTop = ele.offsetTop
            let current = ele.offsetParent
        
            while (current !== null) {
                actualTop += current.offsetTop
                current = current.offsetParent
            }
        
            return actualTop
        },

        updateAnchor: (anchor) => {
            if (anchor !== window.location.hash) {
                if (!anchor) anchor = location.pathname
                const title = "ç§‹ç è®°å½•"
                window.history.replaceState({
                    url: location.href,
                    title
                }, title, anchor)
            }
        },


        throttle: function (func, wait, options) {
            let timeout, context, args
            let previous = 0
            if (!options) options = {}
        
            const later = function () {
                previous = options.leading === false ? 0 : new Date().getTime()
                timeout = null
                func.apply(context, args)
                if (!timeout) context = args = null
            }
        
            const throttled = function () {
                const now = new Date().getTime()
                if (!previous && options.leading === false) previous = now
                
                const remaining = wait - (now - previous)
                context = this
                args = arguments
                if (remaining <= 0 || remaining > wait) {
                    if (timeout) {
                        clearTimeout(timeout)
                        timeout = null
                    }
                    previous = now
                    func.apply(context, args)
                    if (!timeout) context = args = null
                } else if (!timeout && options.trailing !== false) {
                    timeout = setTimeout(later, remaining)
                }
            }
        
            return throttled
        },

        getScrollPercent: (currentTop, ele) => {
            const docHeight = ele.clientHeight
            const winHeight = document.documentElement.clientHeight
            const headerHeight = ele.offsetTop
            const contentMath = (docHeight > winHeight) ? (docHeight - winHeight) : (document.documentElement.scrollHeight - winHeight)
            const scrollPercent = (currentTop - headerHeight) / (contentMath)
            const scrollPercentRounded = Math.round(scrollPercent * 100)
            const percentage = (scrollPercentRounded > 100) ? 100 : (scrollPercentRounded <= 0) ? 0 : scrollPercentRounded
            return percentage
        },




    }  



     

    const scrollFnToDo = function () {
      const isToc = true 
      const isAnchor = true 
      const $article = document.getElementById('article-container')
  
      if (!($article && (isToc || isAnchor))) return
  
      let $tocLink, $cardToc, autoScrollToc, $tocPercentage, isExpand
  
      if (isToc) {
        const $cardTocLayout = document.getElementById('card-toc')
        $cardToc = $cardTocLayout.getElementsByClassName('toc-content')[0]
        $tocLink = $cardToc.querySelectorAll('.toc-link')
        $tocPercentage = $cardTocLayout.querySelector('.toc-percentage')
        isExpand = $cardToc.classList.contains('is-expand')
  
        window.mobileToc = {
          open: () => {
            $cardTocLayout.style.cssText = 'animation: toc-open .3s; opacity: 1; right: 55px'
          },
  
          close: () => {
            $cardTocLayout.style.animation = 'toc-close .2s'
            setTimeout(() => {
              $cardTocLayout.style.cssText = "opacity:''; animation: ''; right: ''"
            }, 100)
          }
        }
  
        
        $cardToc.addEventListener('click', e => {
          e.preventDefault()
          const target = e.target.classList
          if (target.contains('toc-content')) return
          const $target = target.contains('toc-link')
            ? e.target
            : e.target.parentElement
          btf.scrollToDest(btf.getEleTop(document.getElementById(decodeURI($target.getAttribute('href')).replace('#', ''))), 300)
          if (window.innerWidth < 900) {
            window.mobileToc.close()
          }
        })
  
        autoScrollToc = item => {
          const activePosition = item.getBoundingClientRect().top
          const sidebarScrollTop = $cardToc.scrollTop
          if (activePosition > (document.documentElement.clientHeight - 100)) {
            $cardToc.scrollTop = sidebarScrollTop + 150
          }
          if (activePosition < 100) {
            $cardToc.scrollTop = sidebarScrollTop - 150
          }
        }
      }
  
      
      const list = $article.querySelectorAll('h1,h2,h3,h4,h5,h6')
      let detectItem = ''
      const findHeadPosition = function (top) {
        if (top === 0) {
          return false
        }
  
        let currentId = ''
        let currentIndex = ''
  
        list.forEach(function (ele, index) {
          if (top > btf.getEleTop(ele) - 80) {
            const id = ele.id
            currentId = id ? '#' + encodeURI(id) : ''
            currentIndex = index
          }
        })
  
        if (detectItem === currentIndex) return
  
        if (isAnchor) btf.updateAnchor(currentId)
  
        detectItem = currentIndex
  
        if (isToc) {
          $cardToc.querySelectorAll('.active').forEach(i => { i.classList.remove('active') })
  
          if (currentId === '') {
            return
          }
  
          const currentActive = $tocLink[currentIndex]
          currentActive.classList.add('active')
  
          setTimeout(() => {
            autoScrollToc(currentActive)
          }, 0)
  
          if (isExpand) return
          let parent = currentActive.parentNode
  
          for (; !parent.matches('.toc'); parent = parent.parentNode) {
            if (parent.matches('li')) parent.classList.add('active')
          }
        }
      }
  
      
      window.tocScrollFn = btf.throttle(() => {
        const currentTop = window.scrollY || document.documentElement.scrollTop
        
         if(isToc){
          $tocPercentage.textContent = btf.getScrollPercent(currentTop, $article)
        }
        findHeadPosition(currentTop)
      }, 100)
  
      window.addEventListener('scroll', tocScrollFn)
    }
  

    scrollFnToDo()
</script>





    </section>
     

</aside></div>
	<footer class="Qc_footer">
		<div class="Qc_container">
			<div class="item">
				<p>2018 - 2023 ç‰ˆæƒæ‰€æœ‰ Â©<a href="http://beian.miit.gov.cn/">é—½ICPå¤‡2021005633å·-2</a></p>
			</div>

			<div class="item">
				<p>
					<strong>æœ¬ç«™ç”± <span style="color:blue;font:bold;">Hugo</span> é©±åŠ¨çš„ 
						<a href="https://github.com/zhenqicai/hugo-theme-kiwi" target="_blank" >hugo-theme-kiwi V0.0.1</a> ä¸»é¢˜å¼ºåŠ›æ”¯æ’‘</strong>
				</p>
			</div>
		
		</div>
		</div>
	</footer>

	<style>
		.joe_action {
			position: fixed;
			bottom: 90px;
			right: 30px;
			z-index: 333;
		}


		.joe_action_item.scroll.active {
			visibility: visible;
			-webkit-transform: scale(1);
			transform: scale(1);
		}

		.joe_action_item.scroll {
			visibility: hidden;
			-webkit-transform: scale(0);
			transform: scale(0);
			transition: visibility 0.35s, -webkit-transform 0.35s;
			transition: visibility 0.35s, transform 0.35s;
			transition: visibility 0.35s, transform 0.35s, -webkit-transform 0.35s;
		}

		.joe_action_item {
			box-shadow: rgb(0 0 0 / 10%) 0px 0px 10px, rgb(0 0 0 / 20%) 0px 5px 20px;
			background: var(--darkreader-bg--background);
		}
		.joe_action_item {
			position: relative;
			display: flex;
			align-items: center;
			justify-content: center;
			width: 40px;
			height: 40px;
			background: var(--background);
			border-radius: 50%;
			cursor: pointer;
			margin-top: 15px;
			box-shadow: 0 0 10px rgb(0 0 0 / 10%), 0 5px 20px rgb(0 0 0 / 20%);
		}
		.joe_action_item svg {
			position: absolute;
			width: 25px;
			height: 25px;
			fill: var(--theme);
		}



		.joe_action_item.mode svg{-webkit-transform:scale(0);transform:scale(0);opacity:0}
		.joe_action_item.mode svg.active{-webkit-transform:scale(1);transform:scale(1);opacity:1}
		
	</style>


	<div class="joe_action">
		<div class="joe_action_item scroll ">
			<svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" width="25" height="25">
				<path d="M725.902 498.916c18.205-251.45-93.298-410.738-205.369-475.592l-6.257-3.982-6.258 3.414c-111.502 64.853-224.711 224.142-204.8 475.59-55.751 53.476-80.214 116.623-80.214 204.8v15.36l179.2-35.27c11.378 40.39 58.596 69.973 113.21 69.973 54.613 0 101.262-29.582 112.64-68.836l180.337 36.41v-15.36c-.569-89.885-25.031-153.6-82.489-206.507zM571.733 392.533c-33.564 31.29-87.04 28.445-118.329-5.12s-28.444-87.04 5.12-117.76c33.565-31.289 87.04-28.444 118.33 5.12s28.444 86.471-5.12 117.76zm-56.32 368.64c-35.84 0-64.284 29.014-64.284 64.285 0 35.84 54.044 182.613 64.284 182.613s64.285-146.773 64.285-182.613c0-35.271-29.014-64.285-64.285-64.285z"></path>
			</svg>
		</div>
		<div class="joe_action_item mode">
			<svg class="icon-1 " viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" width="25" height="25">
				<path d="M587.264 104.96c33.28 57.856 52.224 124.928 52.224 196.608 0 218.112-176.128 394.752-393.728 394.752-29.696 0-58.368-3.584-86.528-9.728C223.744 832.512 369.152 934.4 538.624 934.4c229.376 0 414.72-186.368 414.72-416.256 1.024-212.992-159.744-389.12-366.08-413.184z"></path>
				<path d="M340.48 567.808l-23.552-70.144-70.144-23.552 70.144-23.552 23.552-70.144 23.552 70.144 70.144 23.552-70.144 23.552-23.552 70.144zM168.96 361.472l-30.208-91.136-91.648-30.208 91.136-30.208 30.72-91.648 30.208 91.136 91.136 30.208-91.136 30.208-30.208 91.648z"></path>
			</svg>
			<svg class="icon-2 active" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" width="25" height="25">
				<path d="M234.24 512a277.76 277.76 0 1 0 555.52 0 277.76 277.76 0 1 0-555.52 0zM512 187.733a42.667 42.667 0 0 1-42.667-42.666v-102.4a42.667 42.667 0 0 1 85.334 0v102.826A42.667 42.667 0 0 1 512 187.733zm-258.987 107.52a42.667 42.667 0 0 1-29.866-12.373l-72.96-73.387a42.667 42.667 0 0 1 59.306-59.306l73.387 72.96a42.667 42.667 0 0 1 0 59.733 42.667 42.667 0 0 1-29.867 12.373zm-107.52 259.414H42.667a42.667 42.667 0 0 1 0-85.334h102.826a42.667 42.667 0 0 1 0 85.334zm34.134 331.946a42.667 42.667 0 0 1-29.44-72.106l72.96-73.387a42.667 42.667 0 0 1 59.733 59.733l-73.387 73.387a42.667 42.667 0 0 1-29.866 12.373zM512 1024a42.667 42.667 0 0 1-42.667-42.667V878.507a42.667 42.667 0 0 1 85.334 0v102.826A42.667 42.667 0 0 1 512 1024zm332.373-137.387a42.667 42.667 0 0 1-29.866-12.373l-73.387-73.387a42.667 42.667 0 0 1 0-59.733 42.667 42.667 0 0 1 59.733 0l72.96 73.387a42.667 42.667 0 0 1-29.44 72.106zm136.96-331.946H878.507a42.667 42.667 0 1 1 0-85.334h102.826a42.667 42.667 0 0 1 0 85.334zM770.987 295.253a42.667 42.667 0 0 1-29.867-12.373 42.667 42.667 0 0 1 0-59.733l73.387-72.96a42.667 42.667 0 1 1 59.306 59.306l-72.96 73.387a42.667 42.667 0 0 1-29.866 12.373z"></path>
			</svg>
		</div>
	</div>

	

	

	
	<script src="https://hanzhongzi.github.io/js/highlight.js"></script>
	<script>hljs.initHighlightingOnLoad();</script>

   

   <script>
	 function registerImageLoadEvent() {
		const images = document.querySelectorAll('.sidebar img, .Qc_post img, .vendors-list img');
				
		const callback = (entries) => {
			entries.forEach(item => {
				if (item.intersectionRatio > 0) {
					let ele = item.target;
					let imgSrc = ele.getAttribute('src');
					ele.setAttribute("src","1.png")
					ele.setAttribute("data-lazy-src",imgSrc)
					ele.classList.add("lazyload")
			
				}
			})
		};

		Array.from(images).forEach(img => {
			const bg = '/images/loading.gif'

			img.setAttribute("data-lazy-src",img.src)
			img.src = bg
		})
		
	
	}

	registerImageLoadEvent()

   </script>


 <script src="https://hanzhongzi.github.io/js/lazyload.life.min.js"></script>

 <script>
	const lazyloadImg = () => {
      window.lazyLoadInstance = new LazyLoad({
        elements_selector: 'img',
        threshold: 0,
        data_src: 'lazy-src'
      })
    }

	lazyloadImg()
 </script>


	</div>
</body>



</html>



<script>
	
	var mybutton = document.querySelector(".joe_action .joe_action_item.scroll")
    window.onscroll = function () {
        if (document.body.scrollTop > 200 || document.documentElement.scrollTop > 200) {
            
            
			mybutton.classList.add("active")
        } else {
            
            
			mybutton.classList.remove("active")
        }
    };

	mybutton.addEventListener("click",() => {
		document.documentElement.scrollTop = document.body.scrollTop = 0;
	})
	


</script>



<script>
	var themeBtn = document.querySelector(".joe_action .joe_action_item.mode")
	let icon_1 = document.querySelector(".joe_action .joe_action_item.mode .icon-1")
	let icon_2 = document.querySelector(".joe_action .joe_action_item.mode .icon-2")
    themeBtn.addEventListener("click", () => {
		
        if (icon_1.classList.contains("active")) {
            icon_1.classList.remove('active');
			icon_2.classList.add('active');
			document.querySelector("html").removeAttribute("data-night")
            localStorage.setItem("pref-theme", 'light');
        } else {
			icon_2.classList.remove('active');
			icon_1.classList.add('active');
			document.querySelector("html").setAttribute("data-night","night")
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
